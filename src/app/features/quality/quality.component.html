<div class="quality-container">
    <div class="page-header">
        <div>
            <h1 class="page-title">Quality & Defects</h1>
            <p class="page-subtitle">Track defects and quality metrics</p>
        </div>
        <p-button label="Report Defect" icon="pi pi-plus" (click)="openDefectDialog()"></p-button>
    </div>

    <!-- Quality Metrics -->
    <div class="metrics-grid">
        <p-card styleClass="metric-card">
            <div class="metric-content">
                <span class="metric-value">{{ metrics.ppm }}</span>
                <span class="metric-label">PPM</span>
            </div>
        </p-card>
        <p-card styleClass="metric-card success">
            <div class="metric-content">
                <span class="metric-value">{{ metrics.ftq }}%</span>
                <span class="metric-label">FTQ</span>
            </div>
        </p-card>
        <p-card styleClass="metric-card warning">
            <div class="metric-content">
                <span class="metric-value">{{ metrics.scrapRate }}%</span>
                <span class="metric-label">Scrap Rate</span>
            </div>
        </p-card>
        <p-card styleClass="metric-card danger">
            <div class="metric-content">
                <span class="metric-value">{{ metrics.totalDefects }}</span>
                <span class="metric-label">Total Defects</span>
            </div>
        </p-card>
    </div>

    <!-- Pareto Chart -->
    <p-card>
        <ng-template pTemplate="header">
            <div class="card-header">
                <h2 class="card-title">Defect Pareto Analysis</h2>
            </div>
        </ng-template>
        <div class="chart-container">
            <p-chart type="bar" [data]="paretoChartData" [options]="chartOptions"></p-chart>
        </div>
    </p-card>
</div>

<p-dialog header="Report Defect" [(visible)]="showDefectDialog" [modal]="true" [style]="{ width: '500px' }">
    <div class="dialog-form">
        <div class="form-field">
            <label>Defect Type</label>
            <p-select [options]="defectTypes" optionLabel="Description_Defect" placeholder="Select type" [style]="{ width: '100%' }"></p-select>
        </div>
        <div class="form-field">
            <label>Quantity</label>
            <p-inputNumber [min]="1" [style]="{ width: '100%' }"></p-inputNumber>
        </div>
    </div>
    <ng-template pTemplate="footer">
        <p-button label="Cancel" [text]="true" (click)="closeDefectDialog()"></p-button>
        <p-button label="Save" (click)="closeDefectDialog()"></p-button>
    </ng-template>
</p-dialog>

<p-toast position="top-right"></p-toast>
